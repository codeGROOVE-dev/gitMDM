checks:
  hostname:
    all: hostname

  uname:
    linux: uname -a
    darwin: uname -a
    freebsd: uname -a
    openbsd: uname -a

  users:
    linux: cat /etc/passwd
    darwin: dscl . -list /Users | grep -v ^_
    freebsd: cat /etc/passwd
    openbsd: cat /etc/passwd

  network:
    linux: ip addr show 2>/dev/null || ifconfig -a
    darwin: ifconfig -a
    freebsd: ifconfig -a
    openbsd: ifconfig -a

  diskencryption:
    linux: lsblk -o NAME,FSTYPE,SIZE,MOUNTPOINT,TYPE,STATE 2>/dev/null | grep -v loop
    darwin: diskutil apfs list | grep -E "(Encryption|Volume|Role)" | head -20
    freebsd: geli status 2>/dev/null || echo "GELI not configured"
    openbsd: bioctl -i softraid0 2>/dev/null || echo "No encrypted volumes"

  firewall:
    linux: iptables -L -n 2>/dev/null | head -50 || echo "Firewall not accessible"
    darwin: pfctl -s rules 2>/dev/null | head -20 || echo "Firewall not accessible"
    freebsd: pfctl -s rules 2>/dev/null | head -20 || echo "Firewall not accessible"
    openbsd: pfctl -s rules 2>/dev/null | head -20 || echo "Firewall not accessible"

  screensaver:
    linux: |
      gsettings get org.gnome.desktop.screensaver lock-enabled 2>/dev/null ||
      xset q 2>/dev/null | grep -A2 "Screen Saver" ||
      echo "Screensaver settings not accessible"
    darwin: |
      defaults read com.apple.screensaver askForPassword 2>/dev/null &&
      defaults read com.apple.screensaver askForPasswordDelay 2>/dev/null ||
      echo "Not configured"

  passwordpolicy:
    linux: |
      grep -E "^PASS_MAX_DAYS|^PASS_MIN_DAYS|^PASS_MIN_LEN|^PASS_WARN_AGE" /etc/login.defs 2>/dev/null ||
      echo "Password policy not configured"
    darwin: pwpolicy getaccountpolicies 2>/dev/null | head -50 || echo "Password policy not accessible"
    freebsd: grep -E "^password" /etc/pam.d/system 2>/dev/null || echo "PAM not configured"
    openbsd: grep -E "^password" /etc/login.conf 2>/dev/null | head -20 || echo "Login config not found"

  updates:
    linux: |
      apt list --upgradable 2>/dev/null | head -20 ||
      yum check-update 2>/dev/null | head -20 ||
      dnf check-update 2>/dev/null | head -20 ||
      echo "Package manager not found"
    darwin: softwareupdate -l 2>/dev/null | head -30 || echo "Updates not accessible"
    freebsd: pkg audit 2>/dev/null | head -20 || echo "pkg audit not available"
    openbsd: syspatch -c 2>/dev/null || echo "syspatch not available"

  antivirus:
    linux: |
      systemctl status clamav-daemon 2>/dev/null | head -10 ||
      ps aux | grep -E "(clam|sophos|mcafee|symantec)" | grep -v grep | head -5 ||
      echo "No antivirus detected"
    darwin: |
      ps aux | grep -E "(XProtect|MRT|Sophos|McAfee|Symantec)" | grep -v grep | head -5 ||
      echo "No antivirus detected"

  audit:
    linux: auditctl -l 2>/dev/null | head -20 || echo "Audit not configured"
    darwin: audit -s 2>/dev/null || echo "Audit not accessible"
    freebsd: auditctl -l 2>/dev/null | head -20 || echo "Audit not configured"
    openbsd: echo "Audit subsystem check not implemented"

  processes:
    all: ps aux | head -30

  systeminfo:
    linux: hostnamectl 2>/dev/null || cat /etc/os-release 2>/dev/null || echo "System info not available"
    darwin: system_profiler SPSoftwareDataType
    freebsd: freebsd-version
    openbsd: sysctl kern.version
